<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['treemap']});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Location', 'Parent', 'テストケース数', '実行回数'],
          ['メール主機能',  null, 0,  0],
          ['メール作成', 'メール主機能', 521,  6],
          ['メール受信', 'メール主機能', 624,  4],
          ['メール送信', 'メール主機能', 213,  2],
          ['他メーラ互換性', 'メール主機能', 34, 2],
          ['POP3', 'メール主機能', 690,  4],
          ['SMTP', 'メール主機能', 453,  1],
          ['IMAP4', 'メール主機能', 1245,  1],
          ['SMIME', 'メール主機能', 55,  3],
          ['添付ファイル種別', 'メール主機能', 23,  1],
          ['添付ファイル暗号化', 'メール主機能', 30, 1],
          ['X-header', 'メール主機能', 234,  1],
          ['APOP', 'メール主機能', 15,  0]
        ]);

        tree = new google.visualization.TreeMap(document.getElementById('chart_div'));

        tree.draw(data, {
          minColor: '#f00',
          midColor: '#ddd',
          maxColor: '#0d0',
          headerHeight: 15,
          fontColor: 'black',
          showScale: true,
          generateTooltip: showFullTooltip
        });

        function showFullTooltip(row, size, value) {
          return '<div style="background:#fd9; padding:10px; border-style:solid">' +
                '<span style="font-family:Courier"><b>' + data.getValue(row, 0) +
                '</b>, ' + data.getValue(row, 1) + ', ' + data.getValue(row, 2) +
                ', ' + data.getValue(row, 3) + '</span><br>' +
                data.getColumnLabel(2) + ': ' + size + '<br>' +
                data.getColumnLabel(3) + ': ' + value + '回 </div>';
        }


      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html>
